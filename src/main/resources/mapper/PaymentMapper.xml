<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="ko.dh.goot.dao.PaymentMapper">

	<select id="existsByPaymentId" resultType="int">
        SELECT COUNT(1)
        FROM payment
        WHERE payment_id = #{paymentId}
    </select>
    
	<insert id="insertPayment" parameterType="ko.dh.goot.dto.Payment" useGeneratedKeys="true" keyProperty="paymentId">
        INSERT INTO payment (
            order_id, payment_method, payment_status, tid,
            approved_at, amount, cancel_amount, created_at, updated_at
        ) VALUES (
            #{orderId}, #{paymentMethod}, #{paymentStatus}, #{tid},
            #{approvedAt}, #{amount}, #{cancelAmount}, NOW(), NOW()
        )
    </insert>

    <select id="selectByOrderId" parameterType="long" resultType="ko.dh.goot.dto.Payment">
        SELECT * FROM payment WHERE order_id = #{orderId}
    </select>

    <update id="updatePaymentStatus" parameterType="ko.dh.goot.dto.Payment">
        UPDATE payment
        SET payment_status = #{paymentStatus},
            approved_at = #{approvedAt},
            updated_at = NOW()
        WHERE order_id = #{orderId}
    </update>
	
	
</mapper>